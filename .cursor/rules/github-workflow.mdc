---
description: GitHub CLI and git workflow guidance. Use GH CLI for PRs/branches/commits, bd (beads) for task tracking.
alwaysApply: true
---

# GitHub & Git Workflow

## Purpose

This rule defines how to use GitHub CLI and git for repository operations, while using **bd** (beads) for task/issue tracking.

## GitHub CLI Usage

When asked about a GitHub task, use the GH CLI to execute commands.

### Use GitHub CLI For:
- **Pull Requests:** create, review, merge, list, comment
- **Branches:** create, delete, checkout, list
- **Commits:** view history, show commits
- **Repository operations:** clone, fork, status
- **GitHub Actions:** view runs, trigger workflows

### Task Tracking: Use bd (beads)

**Do NOT use GitHub Issues for tracking work.** Use **bd** (beads) instead:
- **Tool:** bd (beads) ‚Äì distributed, git-backed issue tracker for AI agents. Issues live in `.beads/` (JSONL), versioned and merged like code. Hash-based IDs (e.g. `bd-a1b2`) avoid merge collisions.
- **Docs:** [github.com/steveyegge/beads](https://github.com/steveyegge/beads) ‚Äì installation, agent workflow, essential commands.
- **Run** `bd onboard` to get started (see AGENTS.md).

```bash
bd ready                    # List tasks with no open blockers
bd create "Title" -p 0      # Create a task (e.g. P0)
bd dep add <child> <parent> # Link tasks (blocks, parent-child)
bd show <id>                 # View task details and audit trail
bd update <id> --status in_progress  # Claim work
bd close <id>                # Complete work
bd sync                      # Sync with git (run after commits, before push)
```

## Workflow Process

When executing git/GitHub tasks:

1. **Create a plan** - Break down the task into steps
2. **Create content** - Draft any necessary content in `.ai_working/` folder
3. **Execute the plan** - Run commands and make changes
4. **Reference bd issues** - When work is tied to a bd issue, include the issue id in commits and PRs

## PR Workflow with bd

### Creating PRs

When work is tied to a bd issue, reference it in the PR:

```bash
gh pr create --title "<issue-id>: Fix login bug" --body "## Summary
Fixes <issue-id>

## Changes
- Fixed authentication flow
- Updated error handling

## Test Plan
- [ ] Tested with valid credentials
- [ ] Tested with invalid credentials
"
```

### PR Title Format (when linked to bd issue)
```
<issue-id>: Brief description of changes
```

### PR Body Requirements
- **Summary:** Brief overview
- **bd Reference:** "Fixes \<issue-id\>" or "Related to \<issue-id\>" when applicable
- **Changes:** Bullet list of changes
- **Test Plan:** How to verify the changes

## Commit Message Format

### When work is tied to a bd issue
Prefix with the bd issue id:

```bash
git commit -m "<issue-id>: Fix password validation bug"
```

### Format Rules
- When referencing a bd issue: prefix with `<issue-id>: `
- Use present tense: "Fix bug" not "Fixed bug"
- Keep under 72 characters for first line
- Add details in commit body if needed
- After committing: run `bd sync` before `git push` to keep bd in sync with git

### Examples

‚úÖ **Good (with bd issue):**
```
<issue-id>: Fix password validation for special characters
<issue-id>: Add user profile image upload endpoint
```

‚úÖ **Good (no bd issue ‚Äì use conventional commit):**
```
docs: Update API documentation for user endpoints
chore: Update npm dependencies
ci: Fix GitHub Actions workflow
```

‚ùå **Bad:**
```
fix bug              (no issue or conventional prefix)
Fixed the login      (past tense)
updates              (vague)
```

## Communication Style

When executing a git-related task, prepend messages with üìã emoji.

**Example:**
```
üìã Creating PR for <issue-id>...
```

## bd Integration

### Workflow
- **Create/claim work:** `bd create "Title"`, `bd ready`, `bd update <id> --status in_progress`
- **Commit format (with issue):** `<issue-id>: description`
- **PR title/body:** Include "Fixes \<issue-id\>" or "Related to \<issue-id\>" when applicable
- **Before push:** Run `bd sync` then `git push` (see AGENTS.md "Landing the Plane")

### Linking commits to bd
- bd syncs with git; run `bd sync` after commits to keep issues and git in sync
- Reference the bd issue id (hash-based, e.g. `bd-a1b2` or hierarchical `bd-a3f8.1`) in commit messages and PRs when work is tied to an issue
- Full usage and agent workflow: [github.com/steveyegge/beads](https://github.com/steveyegge/beads)

## Common Commands

### Pull Requests
```bash
# Create PR
gh pr create --title "<issue-id>: Title" --body "Fixes <issue-id>"

# List PRs
gh pr list

# View PR
gh pr view 123

# Merge PR
gh pr merge 123 --squash --delete-branch

# Add comment
gh pr comment 123 --body "Updated per review feedback"
```

### Branches
```bash
# Create branch
git checkout -b feature/<issue-id>-add-feature

# List branches  
git branch -a

# Delete branch
git branch -d feature/DT-123-add-feature
```

### Commits
```bash
# View commit history
git log --oneline -n 20

# Show commit details
git show <commit-hash>

# Amend last commit
git commit --amend -m "<issue-id>: Updated commit message"
```

## Exception: No bd issue (use conventional commit)

When there is no bd issue for the work (e.g. docs-only, chore, ci):
```
docs: Update API documentation for user endpoints
chore: Update npm dependencies
ci: Fix GitHub Actions workflow
```

## Integration with Other Rules

This rule works with:
- **commit-to-github.mdc** - Commit message format and push requirements
- **AGENTS.md** - bd (beads) workflow and "Landing the Plane" (bd sync, git push)
- **pre-commit-checklist.mdc** - Pre-commit validation steps
